<br/>

## ✴ [ 业务数据 ]IHomeModel :id=H2_1

```csharp
//适用于标准报表
public class ReportModel<TModel> : IHomeModel
        where TModel: class
{

       public HomeType HomeType { set; get; }
       public IDictionary<string, object> Properties { get; } = new Dictionary<string, object>();

       //业务数据
       public IEnumerable<TModel> Data { get; set; }
       object IHomeModel.Data { get => this.Data; set => throw new NotImplementedException(); }

       public ReportModel()
       {
            this.Data = Enumerable.Empty<TModel>();
       }
       
}

```

>[!NOTE|style: flat|label: 表头描述]
>
>- `ReportMappingAttribute`用于表头的描述[ 注意:  此描述紧支持`EasyUI`，如果是其他控件，请自行扩展 ]
>
>```csharp
>public enum Align
>{
>      Left,
>      Right,
>      Center
>}
>
>[AttributeUsage(AttributeTargets.Property, AllowMultiple = false, Inherited = false)]
>public class ReportMappingAttribute: System.Attribute
>{
>    
>      //字段顺序
>      public int Order { get; set; }
>
>      //绑定字段
>      public string Field { get; set; }
>
>      //显示名称
>      public string Title { get; set; }
>
>      //字段宽度
>      public int Width { get; set; } = 100;
>
>      //对齐方式
>      public Align Align { get; set; } = Align.Left;
>
>      //格式化函数
>      public string Formatter { get; set; }
>      public ReportMappingAttribute()
>      {
>          
>      }
>
>}
>
>```
>
><br/>

## ✴ [ 数据提供 ]BaseReportSource :id=H2_2

```csharp
 public abstract class BaseReportSource<TModel> : BaseHomeSource
      where TModel: class
 {
      
      public BaseReportSource(HomeOption option)
          : base(option)
      { }

      protected async override Task<IHomeModel> LoadAsync()
      {

            ReportModel<TModel> @model = new ReportModel<TModel>();
            @model.HomeType = this.HomeOption.HomeType;

            //设置: 报表列信息
            this.SetColumns<TModel>();

            //加载业务数据
            await this.LoadAsync(@model);
            return @model;

      }

      //模板: 数据加载
      protected abstract Task LoadAsync(ReportModel<TModel> @model);

}

```

## 🟢 [ 案例说明 ]标准报表 :id=H2_3

```csharp
#region 业务模型
    
public class Notice
{
    
      public string po03801 { get; set; }

      //单元格穿透: formatter(value, record, rowIndex) { ...... }
      [ReportMapping(Title = "标题", Order = 1, Align = Align.Left, Formatter = @"return ""<a href = 'javascript:void(0);' onclick =\"")]
      public string po03802 { get; set; }

      [ReportMapping(Title = "发布人", Order = 1, Align = Align.Left)]
      public string pj00402 { get; set; }

      [ReportMapping(Title = "发布时间", Order = 1, Align = Align.Center)]
      public string po03803 { get; set; }

}

#endregion
                     
#region [ 业务 ]数据配置器
                     
public class NoticeHomeConfig : BaseHomeConfig
{
      public NoticeHomeConfig(YAMLConfig config)
          : base(config)
      { }

      protected override IHomeSource Build(HomeOption option)
      {

            //重置缓存: Key
            Func<string> key = ()=> string.Format("{0}::{1}", sdCommBL.CommFunc.accId, sdCommBL.CommFunc.Pj00401);
            option.Cache.SetCacheKey(key);

            return new NoticeHomeSource(option);

      }
}

#endregion
                     
#region [ 业务 ]数据提供器
                     
public class NoticeHomeSource : BaseReportSource<Notice>
{
    
      public NoticeHomeSource(HomeOption option)
          : base(option)
      {

            //设置更多Src
            this.SetMoreSrc("xxxx.aspx");
      }

      protected override Task LoadAsync(ReportModel<Notice> model)
      {

            string sql = @"select top 5 po03801,po03802,po03803,
                            pj00402 =isnull((select pj00402 from sdpj004 where pj00401=po03805 or  po03805=pj00421 ),'')
                            from sdpo038,sdpj003  where po03804=pj00301 and (po03811=1 or po03809=@po03809)  order by po03803 desc";
            IEnumerable<Notice> Notices = DapperHelper.Query<Notice>(sql, new { po03809 = CommFunc.Pj00401 });
            model.Data = Notices;
            return Task.CompletedTask;

      }

}

#endregion
        
```

