<br/>

## âœ´ [ ä¸šåŠ¡æ•°æ® ]IHomeModel :id=H2_1

```csharp
//é€‚ç”¨äºæ ‡å‡†æŠ¥è¡¨
public class ReportModel<TModel> : IHomeModel
        where TModel: class
{

       public HomeType HomeType { set; get; }
       public IDictionary<string, object> Properties { get; } = new Dictionary<string, object>();

       //ä¸šåŠ¡æ•°æ®
       public IEnumerable<TModel> Data { get; set; }
       object IHomeModel.Data { get => this.Data; set => throw new NotImplementedException(); }

       public ReportModel()
       {
            this.Data = Enumerable.Empty<TModel>();
       }
       
}

```

>[!NOTE|style: flat|label: è¡¨å¤´æè¿°]
>
>- `ReportMappingAttribute`ç”¨äºè¡¨å¤´çš„æè¿°[ æ³¨æ„:  æ­¤æè¿°ç´§æ”¯æŒ`EasyUI`ï¼Œå¦‚æœæ˜¯å…¶ä»–æ§ä»¶ï¼Œè¯·è‡ªè¡Œæ‰©å±• ]
>
>```csharp
>public enum Align
>{
>      Left,
>      Right,
>      Center
>}
>
>[AttributeUsage(AttributeTargets.Property, AllowMultiple = false, Inherited = false)]
>public class ReportMappingAttribute: System.Attribute
>{
>    
>      //å­—æ®µé¡ºåº
>      public int Order { get; set; }
>
>      //ç»‘å®šå­—æ®µ
>      public string Field { get; set; }
>
>      //æ˜¾ç¤ºåç§°
>      public string Title { get; set; }
>
>      //å­—æ®µå®½åº¦
>      public int Width { get; set; } = 100;
>
>      //å¯¹é½æ–¹å¼
>      public Align Align { get; set; } = Align.Left;
>
>      //æ ¼å¼åŒ–å‡½æ•°
>      public string Formatter { get; set; }
>      public ReportMappingAttribute()
>      {
>          
>      }
>
>}
>
>```
>
><br/>

## âœ´ [ æ•°æ®æä¾› ]BaseReportSource :id=H2_2

```csharp
 public abstract class BaseReportSource<TModel> : BaseHomeSource
      where TModel: class
 {
      
      public BaseReportSource(HomeOption option)
          : base(option)
      { }

      protected async override Task<IHomeModel> LoadAsync()
      {

            ReportModel<TModel> @model = new ReportModel<TModel>();
            @model.HomeType = this.HomeOption.HomeType;

            //è®¾ç½®: æŠ¥è¡¨åˆ—ä¿¡æ¯
            this.SetColumns<TModel>();

            //åŠ è½½ä¸šåŠ¡æ•°æ®
            await this.LoadAsync(@model);
            return @model;

      }

      //æ¨¡æ¿: æ•°æ®åŠ è½½
      protected abstract Task LoadAsync(ReportModel<TModel> @model);

}

```

## ğŸŸ¢ [ æ¡ˆä¾‹è¯´æ˜ ]æ ‡å‡†æŠ¥è¡¨ :id=H2_3

```csharp
#region ä¸šåŠ¡æ¨¡å‹
    
public class Notice
{
    
      public string po03801 { get; set; }

      //å•å…ƒæ ¼ç©¿é€: formatter(value, record, rowIndex) { ...... }
      [ReportMapping(Title = "æ ‡é¢˜", Order = 1, Align = Align.Left, Formatter = @"return ""<a href = 'javascript:void(0);' onclick =\"")]
      public string po03802 { get; set; }

      [ReportMapping(Title = "å‘å¸ƒäºº", Order = 1, Align = Align.Left)]
      public string pj00402 { get; set; }

      [ReportMapping(Title = "å‘å¸ƒæ—¶é—´", Order = 1, Align = Align.Center)]
      public string po03803 { get; set; }

}

#endregion
                     
#region [ ä¸šåŠ¡ ]æ•°æ®é…ç½®å™¨
                     
public class NoticeHomeConfig : BaseHomeConfig
{
      public NoticeHomeConfig(YAMLConfig config)
          : base(config)
      { }

      protected override IHomeSource Build(HomeOption option)
      {

            //é‡ç½®ç¼“å­˜: Key
            Func<string> key = ()=> string.Format("{0}::{1}", sdCommBL.CommFunc.accId, sdCommBL.CommFunc.Pj00401);
            option.Cache.SetCacheKey(key);

            return new NoticeHomeSource(option);

      }
}

#endregion
                     
#region [ ä¸šåŠ¡ ]æ•°æ®æä¾›å™¨
                     
public class NoticeHomeSource : BaseReportSource<Notice>
{
    
      public NoticeHomeSource(HomeOption option)
          : base(option)
      {

            //è®¾ç½®æ›´å¤šSrc
            this.SetMoreSrc("xxxx.aspx");
      }

      protected override Task LoadAsync(ReportModel<Notice> model)
      {

            string sql = @"select top 5 po03801,po03802,po03803,
                            pj00402 =isnull((select pj00402 from sdpj004 where pj00401=po03805 or  po03805=pj00421 ),'')
                            from sdpo038,sdpj003  where po03804=pj00301 and (po03811=1 or po03809=@po03809)  order by po03803 desc";
            IEnumerable<Notice> Notices = DapperHelper.Query<Notice>(sql, new { po03809 = CommFunc.Pj00401 });
            model.Data = Notices;
            return Task.CompletedTask;

      }

}

#endregion
        
```

